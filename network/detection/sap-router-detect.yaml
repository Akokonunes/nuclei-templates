id: sap-router-detect

info:
  name: SAProuter  - Detect
  author: pussycat0x
  severity: info
  description: |
    The SAProuter is a proxy program that controls and secures communication between SAP systems and external networks.
  metadata:
    verified: true
    shodan-query: product:"SAProuter"
  tags: network,tcp,sap,tech

tcp:
  - inputs:
      - data: "00000000"
        type: hex

    host:
      - "{{Hostname}}"
    port: 3200

    read-size: 1024

    matchers:
      - type: word
        part: raw
        words:
          - "SAProuter"
          - "network interface"
        condition: and

    extractors:
      - type: regex
        regex:
          - "SAProuter ([0-9.]+)"
