id: direct-connect-detect

info:
  name: Direct Connect P2P - Detect
  author: pussycat0x
  severity: info
  reference:
    - https://en.wikipedia.org/wiki/Direct_Connect_(protocol)
  metadata:
    verfied: true
    shodan-query: product:"Direct Connect P2P"
    max-request: 1
  tags: js,network,eunm,dc,direct-connect,p2p

tcp:
  - inputs:
      - data: 00000000
        type: hex

    host:
      - "{{Hostname}}"

    port: 548
    read-size: 1024

    matchers:
      - type: word
        words:
          - "$MyNick bb3096"
          - "$Lock EXTENDEDPROTOCOL"
        condition: or
