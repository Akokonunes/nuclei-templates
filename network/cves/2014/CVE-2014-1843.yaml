id: CVE-2014-1843
info:
  name: Titan FTP Server < 10.40 - User Properties Traversal
  author: pussycat0x
  severity: medium
  description: |
    Titan FTP Server versions prior to 10.40 build 1829 contain a directory traversal vulnerability that allows remote attackers to view "Properties" of user folders via path traversal. This enables user enumeration and access to sensitive user information that could aid in launching further attacks.
  metadata:
    verified: true
    shodan-query: product:"Titan ftpd"
    max-request: 1
  tags: cve,cve2014,network,ftp,titan-ftp,tcp,passive

tcp:
  - inputs:
      - data: 00000000
        type: hex

    host:
      - "{{Hostname}}"
    port: 21
    read-size: 1024

    matchers:
      - type: dsl
        dsl:
          - "contains(raw, 'Titan')"
          - "compare_versions(version, '< 10.40')"
        condition: and

    extractors:
      - type: regex
        group: 1
        name: version
        regex:
          - "Titan FTP Server ([0-9.]+)"
