id: CVE-2006-2173
info:
  name: FileZilla FTP Server 2.2.22 - Buffer Overflow
  author: pussycat0x
  severity: high
  description: |
    FileZilla FTP Server version 2.2.22 contains a buffer overflow vulnerability that allows remote authenticated attackers to cause denial of service and potentially execute arbitrary code. The vulnerability can be triggered by sending excessively long PORT or PASS commands followed by MLSD commands, or through the remote interface.
  metadata:
    verified: true
    shodan-query: product:"FileZilla"
    max-request: 1
  tags: cve,cve2006,network,ftp,filezilla,tcp,passive,buffer-overflow

tcp:
  - inputs:
      - data: 00000000
        type: hex

    host:
      - "{{Hostname}}"
    port: 21
    read-size: 1024

    matchers:
      - type: dsl
        dsl:
          - "contains(raw, 'FileZilla')"
          - "contains(version, '2.2.22')"
        condition: and

    extractors:
      - type: regex
        group: 1
        name: version
        regex:
          - "FileZilla Server version ([0-9.]+)"
