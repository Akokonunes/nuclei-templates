id: CVE-2008-0702
info:
  name: Titan FTP Server 6.03 and 6.0.5.549 - Heap Overflow via Long Commands
  author: pussycat0x
  severity: high
  description: |
    Titan FTP Server versions 6.03 and 6.05 (builds) contain multiple heap-based buffer overflow vulnerabilities. Remote attackers can cause denial of service (daemon crash) or potentially execute arbitrary code by sending excessively long USER, PASS, or other FTP commands that trigger heap overflows.
  metadata:
    verified: true
    shodan-query: product:"Titan ftpd" version:"16.00.2672"
    max-request: 1
  tags: cve,cve2008,network,ftp,titan-ftp,tcp,passive

tcp:
  - inputs:
      - data: 00000000
        type: hex

    host:
      - "{{Hostname}}"
    port: 21
    read-size: 1024

    matchers:
      - type: dsl
        dsl:
          - "contains(raw, 'Titan')"
          - "contains(version, '6.03') || contains(version, '6.0.5.549')"
        condition: and

    extractors:
      - type: regex
        group: 1
        name: version
        regex:
          - "Titan FTP Server ([0-9.]+)"
