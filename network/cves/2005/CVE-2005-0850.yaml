id: CVE-2005-0850
info:
  name: FileZilla Server < 0.9.6 - DoS via MS-DOS Device Names
  author: pussycat0x
  severity: medium
  description: |
    FileZilla Server versions prior to 0.9.6 are vulnerable to denial of service when processing filenames containing MS-DOS device names such as CON, NUL, COM1, LPT1, and others. Remote attackers can cause the server to crash or become unresponsive by requesting files with these reserved device names.
  metadata:
    verified: true
    shodan-query: product:"FileZilla"
    max-request: 1
  tags: cve,cve2005,network,ftp,filezilla,tcp,passive

tcp:
  - inputs:
      - data: 00000000
        type: hex

    host:
      - "{{Hostname}}"
    port: 21
    read-size: 1024

    matchers:
      - type: dsl
        dsl:
          - "contains(raw, 'FileZilla')"
          - "compare_versions(version, '< 0.9.6')"
        condition: and

    extractors:
      - type: regex
        group: 1
        name: version
        regex:
          - "FileZilla Server version ([0-9.]+)"
