id: unauth-vnc-server-detect

info:
  name: Unauthenticated VNC  Server - Detect
  author: pussycat0x
  severity: critical
  description: |
    The remote host had a VNC server that permitted access without requiring authentication.
  metadata:
    verified: true
    shodan-query: product:"vnc"
  tags: js,network,vnc,unauth,misconfig

javascript:
  - pre-condition: |
      isPortOpen(Host,Port);
    code: |
      var vnc = require('nuclei/vnc');
      var client = new vnc.VNCClient();
      var resp = client.Connect(Host, Port, " ");
      resp;

    args:
      Host: "{{Host}}"
      Port: 5900

    matchers:
      - type: dsl
        dsl:
          - "success == true"
          - "response == true"
        condition: and
