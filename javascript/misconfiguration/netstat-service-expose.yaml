id: netstat-service-expose

info:
  name: Netstat Service - Expose
  author: pussycat0x
  severity: low
  description: |
    Port 15 (Netstat) was found exposed, which could have disclosed sensitive network and system information to unauthorized users.
  impact: |
    This exposure increased the risk of information gathering and potential exploitation by attackers.
  metadata:
    verified: true
    zoomeye-query: 'port="15" && "netstat"'
    max-request: 1
  tags: netsat,network,js,tcp

javascript:
  - pre-condition: |
      isPortOpen(Host,Port);
    code: |
      let packet = bytes.NewBuffer();
      const c = require("nuclei/net");
      const cmd = "00000000"
      packet.WriteString(cmd)
      let conn = c.Open('tcp', `${Host}:${Port}`);
      conn.SendHex(packet.Hex());
      const result = conn.RecvString();
      result;

    args:
      Host: "{{Host}}"
      Port: 15

    matchers:
      - type: dsl
        dsl:
          - "success == true"
          - contains(response, "Active Internet connections")
        condition: and

    extractors:
      - type: dsl
        dsl:
          - response
