id: allegro-rompager-detect

info:
  name: Allegro RomPager - Detect
  author: matejsmycka
  severity: info
  description: |
    Allegro RomPager was detected.
    This toolkit is often used in embedded devices such as routers, cameras, and IoT devices.
    Hardware using RomPager is often historical and possibly with default credentials.
  reference:
    - http://rompager.com/
  metadata:
    shodan-query:
      - product:"Allegro RomPager"
  tags: panel,allegro,rompager

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - "Server: Allegro-Software-RomPager/"

      - type: status
        status:
          - 200

      # The uppercase HTML tags are typical for RomPager pages
      - type: word
        part: body
        condition: or
        words:
          - "BGCOLOR"
          - "SCRIPT"
          - "HTML"
          - "BODY"
          - "FONT"
          - "INPUT"
          - "FRAME"

    extractors:
      - type: regex
        part: header
        group: 1
        regex:
          - "RomPager/([\\d\\.]+)"
