id: pinata-api-keys

info:
  name: Pinata API Keys
  author: 0xpugal
  severity: info
  tags: pinata,exposure,api-keys,tokens

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: word
        words:
          - "pinata"
          - "pinata_api_key"
          - "pinata_api_secret"
          - "pinataKey"
          - "pinataSecret"
          - "pinata-key"
          - "pinata_secret"
        case-insensitive: true
        condition: or

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - (?i)pinata[_\-.]?(?:api[_\-.]?)?key\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)pinata[_\-.]?(?:api[_\-.]?)?secret\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)PINATA[_\-.]?(?:API[_\-.]?)?KEY\s*=\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)PINATA[_\-.]?(?:API[_\-.]?)?SECRET\s*=\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)pinata(?:[_\-. ]|)(?:api|Api|API|)?(?:[_\-. ]|)(?:key|Key)\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)pinata(?:[_\-. ]|)(?:api|Api|API|)?(?:[_\-. ]|)(?:secret|Secret)\s*[:=]\s*['"]?([A-Za-z0-9_\-]+)['"]?
          - (?i)"?pinata[_\-.]?(?:api[_\-.]?)?key\"?\s*[:]\s*\"([A-Za-z0-9_\-]+)\"
          - (?i)"?pinata[_\-.]?(?:api[_\-.]?)?secret\"?\s*[:]\s*\"([A-Za-z0-9_\-]+)\"
          - (?i)(?:const|let|var)?\s*pinata[_\-.]?(?:api[_\-.]?)?key\s*=\s*['"]([A-Za-z0-9_\-]+)['"]
          - (?i)(?:const|let|var)?\s*pinata[_\-.]?(?:api[_\-.]?)?secret\s*=\s*['"]([A-Za-z0-9_\-]+)['"]
          - (?i)pinata[^A-Za-z0-9]{0,8}([A-Za-z0-9_\-]{16,128})

    redirects: false
