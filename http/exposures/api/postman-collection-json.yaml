id: postman-collection-json
info:
  name: Postman Collection JSON Exposed
  author: Hamza Sahin
  severity: medium
  description: |
    Detects exposed Postman collections which may disclose endpoints, auth headers, and environment variables.
  tags: api,postman,exposure,inventory,web

requests:
  - method: GET
    path:
      - "{{BaseURL}}/postman.json"
      - "{{BaseURL}}/docs/postman.json"
      - "{{BaseURL}}/api/postman.json"
      - "{{BaseURL}}/postman_collection.json"
      - "{{BaseURL}}/collections/postman.json"
    matchers-condition: and
    matchers:
      # Content-Type: application/json veya Postman vendor tipi
      - type: regex
        part: header
        regex:
          - '(?i)content-type:\s*application/(json|vnd\.postman\.[^;\s]+)'

      # Postman collection "info.name" alanı ipucu
      - type: regex
        part: body
        regex:
          - '(?i)"info"\s*:\s*\{\s*"name"\s*:\s*".+?"'

      # Koleksiyon "item" listesi ipucu
      - type: regex
        part: body
        regex:
          - '(?i)"item"\s*:\s*\['

      # Genelde 200 döner; farklı durumlarda zaten body eşleşmezse fail olur
      - type: status
        status: [200]
