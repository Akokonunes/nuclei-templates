id: CVE-2020-27615
info:
  name: Loginizer < 1.6.4 - Unauthenticated SQL Injection
  author: intelligent-ears
  severity: critical
  description: |
    The Loginizer WordPress plugin before 1.6.4 is vulnerable to unauthenticated
    SQL Injection via the `log` parameter in the `loginizer_dismiss_notice` AJAX action.
  reference:
    - https://wpscan.com/vulnerability/10285
    - https://nvd.nist.gov/vuln/detail/CVE-2020-27615
  tags: cve,wordpress,sqli,wp-plugin,loginizer

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/loginizer/readme.txt"

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "Stable tag:\\s*1\\.6\\.[0-3]\\b"
        part: body

  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php?action=loginizer_dismiss_notice&log=test"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 400
      - type: word
        words:
          - "0"
        part: body
