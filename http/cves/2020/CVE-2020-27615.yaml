id: CVE-2020-27615
info:
  name: "Loginizer (CVE-2020-27615) - Fingerprint (non-exploit)"
  author: your-name
  severity: info
  tags: loginizer,wp,wordpress,cve-2020-27615,fingerprint
  description: |
    Safe fingerprint for Loginizer < 1.6.4 (CVE-2020-27615). This template will:
      1) try to read plugin version from common plugin files (readme or main plugin file), and
      2) verify presence of the loginizer_dismiss_notice admin-ajax action.
    NOTE: This template is intentionally non-exploitative. Do NOT use it to exploit targets
    you do not own or have explicit permission to test.
  reference:
    - "https://nvd.nist.gov/vuln/detail/CVE-2020-27615"
    - "https://loginizer.com/blog/loginizer-1-6-4-security-fix/"
    - "https://www.tenable.com/blog/cve-2020-27615-sql-injection-vulnerability-in-wordpress-loginizer-plugin"

requests:
  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/loginizer/readme.txt"
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "Stable tag:"
        part: body
      - type: regex
        regex:
          - "Stable tag:\\s*1\\.6\\.[0-3]\\b"
          - "Version:\\s*1\\.6\\.[0-3]\\b"
        part: body
    extractors:
      - type: regex
        regex:
          - "Stable tag:\\s*([0-9\\.]+)"
          - "Version:\\s*([0-9\\.]+)"
        name: loginizer_version

  - method: GET
    path:
      - "{{BaseURL}}/wp-content/plugins/loginizer/loginizer.php"
      - "{{BaseURL}}/wp-content/plugins/loginizer/loginizer-main.php"
    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "Version:\\s*1\\.6\\.[0-3]\\b"
          - "Version:\\s*1\\.[0-5]\\.[0-9]\\b"
        part: body
    extractors:
      - type: regex
        regex:
          - "Version:\\s*([0-9\\.]+)"
        name: loginizer_version

  - method: GET
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php?action=loginizer_dismiss_notice&log=test"
    matchers-condition: or
    matchers:
      - type: status
        status:
          - 200
          - 400
      - type: word
        words:
          - "0"
          - "1"
          - "dismiss"
        part: body
      - type: regex
        regex:
          - "(?i)invalid nonce"
          - "(?i)missing_nonce"
          - "(?i)invalid_or_missing_nonce"
        part: body
