id: CVE-2025-59474

info:
  name: Jenkins Sidepanel Unauthorized Agent/Queue Exposure
  author: ivaldivieso
  severity: medium
  description: >
    Jenkins <= 2.527 and LTS <= 2.516.2 exposed the sidepanel on pages accessible
    without Overall/Read (e.g. /securityRealm/signup), leaking agent names and
    build queue information. Fixed by removing the sidepanel in 2.528 / LTS 2.516.3.
  tags: jenkins,exposure,unauth

requests:
  - method: GET
    path:
      - "{{BaseURL}}/securityRealm/signup"
      - "{{BaseURL}}/jenkins/securityRealm/signup"

    # No filtramos por status: 404 también trae el HTML con el leak
    matchers-condition: or
    matchers:
      - type: word
        part: body
        words:
          # EN
          - 'Build Executor Status'
          # ES (por si el Jenkins está en español)
          - 'Estado del ejecutor'
          # ID típico del panel
          - 'id="executors"'
      - type: regex
        part: body
        regex:
          # enlaces del widget a páginas de agentes
          - 'href="[^"]*/computer/[^"]*/?"'

    extractors:
      - type: regex
        name: agents
        part: body
        group: 1
        regex:
          - 'href="[^"]*/computer/([^"/]+)/?"'
