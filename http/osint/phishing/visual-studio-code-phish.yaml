id: visual-studio-code-phish

info:
  name: visual studio code phishing Detection
  author: rxerium
  severity: info
  description: |
    A visual studio code phishing website was detected
  reference:
    - https://visualstudio.com
  metadata:
    max-request: 1
  tags: phishing,visual-studio-code,osint
http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2

    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'Visual Studio Code is a code editor redefined and optimized for building and debugging modern web and cloud applications.  Visual Studio Code is free and available on your favorite platform - Linux, macOS, and Windows.'
          - 'Visual Studio Code - Code Editing. Redefined'
        condition: and

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - '!contains(host,"visualstudio.com")'
# digest: 4a0a00473045022021f2341a7c5428303ef03e828b95a12f6c59557c832779669e332f89569655ed02210090691b1aad68bb51efe10d5c44aed8320c67d348a176e286435ffd01dab80588:922c64590222798bb761d5b6d8e72950