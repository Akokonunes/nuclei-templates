id: visual-studio-code-phish

info:
  name: visual studio code phishing Detection
  author: rxerium
  severity: info
  description: |
    A visual studio code phishing website was detected
  reference:
    - https://visualstudio.com
  metadata:
    max-request: 1
  tags: phishing,visual-studio-code,osint
http:
  - method: GET
    path:
      - "{{BaseURL}}"

    host-redirects: true
    max-redirects: 2

    matchers-condition: and
    matchers:
      - type: word
        words:
          - 'Visual Studio Code is a code editor redefined and optimized for building and debugging modern web and cloud applications.  Visual Studio Code is free and available on your favorite platform - Linux, macOS, and Windows.'
          - 'Visual Studio Code - Code Editing. Redefined'
        condition: and

      - type: status
        status:
          - 200

      - type: dsl
        dsl:
          - '!contains(host,"visualstudio.com")'
# digest: 4a0a0047304502201a958c9d98aff42e056c07b5aa0a417cc74348a9abbf86c17fbe22fee81191f3022100e5de5e90a9aae8de9724fe14ca0c41344579961bf92ec06e97fce82dd9ea7d8c:922c64590222798bb761d5b6d8e72950