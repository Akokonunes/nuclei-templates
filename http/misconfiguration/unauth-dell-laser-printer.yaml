id: unauth-dell-laser-printer

info:
  name: Unauthorized Dell Laser Printer - Detect
  author: pussycat0x
  severity: high
  description: Unauthorized Dell Laser Printer web access is exposed.
  metadata:
    max-request: 1
    shodan-query: title="Laser Printer"
  tags: dell,iot,unauth,misconfig,printer

flow: http(1) && http(2)

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains_all(body, '<TITLE>Dell','Laser Printer</TITLE>')"
        condition: and

    extractors:
      - type: regex
        part: body
        name: printer_version
        regex:
          - 'Dell([ 0-9A-Za-z]+).*Laser Printer'

  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/dynamic/config/secure/security.html"

    matchers:
      - type: dsl
        dsl:
          - "status_code == 200"
          - "contains_all(body, 'Security','Security')"
        condition: and
        internal: true
