id: cors-credentialed-reflection
info:
  name: CORS Credentialed Origin Reflection
  author: Hamza Sahin
  severity: high
  description: |
    Detects ACA-Credentials:true with arbitrary Origin reflection,
    enabling credentialed cross-origin reads.
  tags: web,cors,misconfig
requests:
  - method: GET
    path:
      - "{{BaseURL}}/"
    headers:
      Origin: "https://evil.{{interactsh-url}}"
    matchers-condition: and
    matchers:
      - type: word
        part: header
        words: ["Access-Control-Allow-Credentials: true"]
      - type: regex
        part: header
        regex:
          - "(?i)access-control-allow-origin:\\s*https://evil\\.[^\\s]+"
