id: weaviate-exposure

info:
  name: Weaviate - Exposure
  author: DhiyaneshDk
  severity: low
  description: |
    Detected an exposed Weaviate instance by accessing its API endpoints. Verified exposure by identifying meta information, schema details, and specific endpoint references in the response, confirming that the instance was publicly accessible.
  metadata:
    verified: true
    max-request: 1
    shodan-query: title:"Weaviate"
  tags: weaviate,exposure,api

http:
  - method: GET
    path:
      - "{{BaseURL}}/v1/"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "Meta information about this instance/cluster"
          - "view complete schema"
        condition: and

      - type: regex
        part: body
        regex:
          - "\"href\":\"/v1/schema\""

      - type: status
        status:
          - 200
