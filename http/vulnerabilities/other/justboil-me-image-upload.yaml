id: justboil-me-image-upload

info:
  name: JustBoil.me Images Plugin - Exposed Image Upload
  author: 0xr2r
  severity: medium
  description: |
    JustBoil.me Images Plugin for TinyMCE contains an exposed dialog interface that could lead to potential security vulnerabilities. The plugin's dialog-v4.htm file is accessible without proper access controls, which may allow unauthorized access to image upload functionality.
  reference:
    - https://cxsecurity.com/issue/WLB-2019050108
  metadata:
    verified: true
    max-request: 1
    fofa-query: body="/plugins/generic/tinymce/plugins/justboil.me/"
    shodan-query: inurl:"/plugins/generic/tinymce/plugins/justboil.me/"
  tags: justboil,tinymce,plugin,exposure,misconfig

http:
  - method: GET
    path:
      - "{{BaseURL}}/plugins/generic/tinymce/plugins/justboil.me/dialog-v4.htm"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "JustBoil.me Images Plugin"
          - "TinyMCE"
          - "upload_infobar"
        condition: and

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
